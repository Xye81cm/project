#!/usr/bin/env python
# coding: utf-8

# <div class="alert alert-success">
#   <b> ‚úîÔ∏è–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è</b>
# 
# –ü—Ä–∏–≤–µ—Ç, –ì–µ–æ—Ä–≥–∏–π! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ú–∏—Ö–∞–∏–ª, —è –±—É–¥—É –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç. –ü—Ä–µ–¥–ª–∞–≥–∞—é –æ–±—â–∞—Ç—å—Å—è –Ω–∞ '—Ç—ã' :)
# –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ—É–¥–æ–±–Ω–æ - —Å–æ–æ–±—â–∏, –∏ –º—ã –ø–µ—Ä–µ–π–¥–µ–º –Ω–∞ '–í—ã'. –ú–æ—è –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å ‚Äî  –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å —Ç–æ–±–æ–π —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏ –ø–æ–º–æ—á—å —Ç–µ–±–µ —Å—Ç–∞—Ç—å –∫—Ä—É—Ç—ã–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —Ç–æ–±–æ–π –æ—à–∏–±–∫–∏.
# 
# –í–∏–¥–Ω–æ, —á—Ç–æ –∫ –ø—Ä–æ–µ–∫—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω –±–æ–ª—å—à–æ–π —Ç—Ä—É–¥. –í—Å–µ –∫–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã –≤ —Ä–∞–±–æ—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ. –¢–∞–∫ —á—Ç–æ –≤ —Ü–µ–ª–æ–º —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –∑–∞–¥–∞—á–µ–π —Ç–µ–±–µ —É–¥–∞–ª–æ—Å—å.
# 
# –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∞—Å–ø–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ **—Ç—Ä–µ–±—É—é—Ç** —Ç–≤–æ–µ–≥–æ **–≤–Ω–∏–º–∞–Ω–∏—è**. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –Ω–∏–º –ø–æ–º–µ—á–µ–Ω—ã –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º –∏ —Å–∏–º–≤–æ–ª–∞–º–∏ ‚ùå. –ü–æ—Å–ª–µ –∏—Ö –¥–æ—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –ø—Ä–∏–Ω—è—Ç, –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ :) 
#     
# 
# –î–∞–≤–∞–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞–¥ –ø—Ä–æ–µ–∫—Ç–æ–º –≤ –¥–∏–∞–ª–æ–≥–µ: –µ—Å–ª–∏ **—Ç—ã —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—à—å** –≤ –ø—Ä–æ–µ–∫—Ç–µ –ø–æ –º–æ–∏–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º ‚Äî **–ø–∏—à–∏ –æ–± —ç—Ç–æ–º**. –ú–Ω–µ –±—É–¥–µ—Ç –ª–µ–≥—á–µ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Ç—ã –±—É–¥–µ—à—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—é—é —Ñ–æ—Ä–º—É, –∫–æ—Ç–æ—Ä—É—é —è –ø—Ä–∏–∫—Ä–µ–ø–ª—é –Ω–∏–∂–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, **–Ω–µ –ø–µ—Ä–µ–º–µ—â–∞–π, –Ω–µ –∏–∑–º–µ–Ω—è–π –∏ –Ω–µ —É–¥–∞–ª—è–π –º–æ–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏**. –í—Å—ë —ç—Ç–æ –ø–æ–º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ–µ. 
# 
# 
# 
# –ñ–¥—É –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é. –£—Å–ø–µ—Ö–æ–≤ –≤ –∏–∑—É—á–µ–Ω–∏–∏!
# 
# 
# 
# </div>
# <div class="alert alert-block alert-danger"> <b>‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå</b> 
#     –¢–∞–∫ —è –≤—ã–¥–µ–ª—è—é –º–æ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –ù—É–∂–Ω–æ –±—É–¥–µ—Ç —É—á–µ—Å—Ç—å –∏—Ö –∏ –≤–Ω–µ—Å—Ç–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤ —Å–≤–æ—é —Ä–∞–±–æ—Ç—É. </div>
# <div class="alert alert-block alert-warning"> <b>‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ö†Ô∏è</b> 
#     –ñ–µ–ª—Ç—ã–º —è –æ—Ç–º–µ—á—É —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ, –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –ø—Ä–∏ —Ç–≤–æ–µ–π —Ä–∞–±–æ—Ç–µ. –û–Ω–∏ –Ω–æ—Å—è—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä, –Ω–æ –±—É–¥–µ—Ç –∫–ª–∞—Å—Å–Ω–æ, –µ—Å–ª–∏ —Ç—ã –±—É–¥–µ—à—å —É—á–∏—Ç—ã–≤–∞—Ç—å –∏—Ö –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ.</div>
# <div class="alert alert-block alert-success"> <b>‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è</b>
#     –¢–∞–∫ —è –≤—ã–¥–µ–ª—è—é —É–¥–∞—á–Ω—ã–µ –∏ —ç–ª–µ–≥–∞–Ω—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –æ–ø–∏—Ä–∞—Ç—å—Å—è –≤ –±—É–¥—É—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.</div>
# <div class="alert alert-block alert-info">
#     
# –ê –≤ —Ç–∞–∫–æ–º –±–ª–æ–∫–µ —Ç—ã –º–æ–∂–µ—à—å –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –º–µ–Ω—è 
#     
# </div>

# # –í–≤–µ–¥–µ–Ω–∏–µ 
# 
# –¢–µ–ø–µ—Ä—å –º—ã —Ä–∞–±–æ—Ç–∞–µ–º –≤ —Å—Ç–∞—Ä—Ç–∞–ø–µ, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–¥–∞—ë—Ç –ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è. –ù—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, –∫–∞–∫ –≤–µ–¥—É—Ç —Å–µ–±—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏—å–º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. 
# –ù—É–∂–Ω–æ –∏–∑—É—á–∏—Ç—å –≤–æ—Ä–æ–Ω–∫—É –ø—Ä–æ–¥–∞–∂, —É–∑–Ω–∞–π—Ç—å, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –ø–æ–∫—É–ø–∫–∏. –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –ø–æ–∫—É–ø–∫–∏, –∞ —Å–∫–æ–ª—å–∫–æ ‚Äî ¬´–∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç¬ª –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —à–∞–≥–∞—Ö? –ù–∞ –∫–∞–∫–∏—Ö –∏–º–µ–Ω–Ω–æ?
# 
# –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –Ω–∞–¥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã A/A/B-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞. –î–∏–∑–∞–π–Ω–µ—Ä—ã –∑–∞—Ö–æ—Ç–µ–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å —à—Ä–∏—Ñ—Ç—ã –≤–æ –≤—Å—ë–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏, –∞ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –∏—Å–ø—É–≥–∞–ª–∏—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±—É–¥–µ—Ç –Ω–µ–ø—Ä–∏–≤—ã—á–Ω–æ. –î–æ–≥–æ–≤–æ—Ä–∏–ª–∏—Å—å –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º A/A/B-—Ç–µ—Å—Ç–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞–∑–±–∏–ª–∏ –Ω–∞ 3 –≥—Ä—É–ø–ø—ã: 2 –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —à—Ä–∏—Ñ—Ç–∞–º–∏ –∏ –æ–¥–Ω—É —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—É—é ‚Äî —Å –Ω–æ–≤—ã–º–∏. –ù–∞–¥–æ –≤—ã—è—Å–Ω–∏—Ç—å, –∫–∞–∫–æ–π —à—Ä–∏—Ñ—Ç –ª—É—á—à–µ.

# # –ü–ª–∞–Ω —Ä–∞–±–æ—Ç—ã:
# 
# 1) –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –∏–∑—É—á–∏—Ç–µ –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
# 
# 2) –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
# 
# 3) –ò–∑—É—á–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
# 
# 4) –ò–∑—É—á–∏—Ç–µ –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π
# 
# 5) –ò–∑—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è**
#    
#    –•–æ—Ä–æ—à–µ–µ –≤–≤–µ–¥–µ–Ω–∏–µ –≤ –ø—Ä–æ–µ–∫—Ç - –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –≤ –±—É–¥—É—â–µ–º, –∫–æ–≥–¥–∞ —Å–æ–±–µ—Ä–µ—à—å –±–æ–ª—å—à–æ–µ –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏ –æ—Ç–∫—Ä–æ–µ—à—å –ø—Ä–æ–µ–∫—Ç –≤–Ω–æ–≤—åüëç
# 
# </div>
# 

# # –í–æ–ø—Ä–æ—Å—ã
# 
# 1) –ù–µ –ø–æ–Ω—è–ª, –∫–∞–∫ –¥–µ–ª–∞—Ç—å –ø—É–Ω–∫—Ç 5.2. –ß–µ–º –æ–Ω –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –ø—É–Ω–∫—Ç–∞ 5.3?
# 
# 2) –ù–∞–¥–æ –ª–∏ –≤–∫–ª—é—á–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ tutorial –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≤ –ø—É–Ω–∫—Ç–µ 5.3 –∏ 5.4?

# <div class="alert alert-warning">
# 
# **‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ö†Ô∏è**
#    
#    –í 5.2 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è - MainScreen - –ø—Ä–æ–≤–µ—Ä—è–µ–º, –∫–∞–∫–∞—è –¥–æ–ª—è –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –≥—Ä—É–ø–ø–µ 246 —Å–æ–≤–µ—Ä—à–∏–ª–∞ —Å–æ–±—ã—Ç–∏–µ MainScreen –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Å –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–π –¥–æ–ª–µ–π –≥—Ä—É–ø–ø—ã 247. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏, –ø—É–Ω–∫—Ç—ã 5.2 –∏ 5.3 –º–æ–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤ "—Å–¥–µ–ª–∞–π—Ç–µ –ê–ê-—Ç–µ—Å—Ç—ã"
#     –ö–∞—Å–∞—Ç–µ–ª—å–Ω–æ tutorial - –º–æ–∂–Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∞–ø –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
# 
# </div>
# 
# 
# 

# In[1]:


import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats as st
import numpy as np
import math as mth
from scipy.stats import ttest_ind
from plotly import graph_objects as go


# ## –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –∏ –∏–∑—É—á–∏—Ç–µ –æ–±—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

# In[2]:


try:
    data = pd.read_csv('/datasets/logs_exp.csv', sep='\t')
except:
    data = pd.read_csv('https://code.s3.yandex.net/datasets/logs_exp.csv')

display(data.head())


# In[3]:


pd.options.display.max_colwidth = 10000 # –Ω–∞—Å—Ç—Ä–æ–∏–º –≤–∏–¥ –Ω–∞—à–∏—Ö —Ç–∞–±–ª–∏—Ü, –¥–ª—è –Ω–∞—á–∞–ª–∞ –Ω–∞–¥–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã —Å—Ç—Ä–æ–∫–∏ –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
pd.set_option('display.precision', 2) # –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π —Ä–∞–∑ –æ–∫—Ä—É–≥–ª—è—Ç—å, —Å—Ä–∞–∑—É –Ω–∞—Å—Ç—Ä–æ–∏–º —ç—Ç–æ


# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è**
#    
#    –•–æ—Ä–æ—à–æ. –ü—Ä–∏—Å—Ç—É–ø–∏–º –∫ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–µ
# 
# </div>
# 

# ## –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
# 
# ### –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –Ω–∞ —É–¥–æ–±–Ω—ã–µ –¥–ª—è –≤–∞—Å;

# In[4]:


data.columns = ['event_name', 'device_id', 'event_time', 'expld']
display(data.head())


# ### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö. –û—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–π—Ç–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ;

# In[5]:


print(data.info())


# –ù–∞–¥–æ –ø–æ–º–µ–Ω—è—Ç—å —Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö —Å—Ç–æ–ª–±—Ü–∞ event_time

# In[6]:


data['event_time'] = pd.to_datetime(data['event_time'], unit='s')
display(data.head())


# –¢–µ–ø–µ—Ä—å –≤–µ–∑–¥–µ –≤–µ—Ä–Ω—ã–µ —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

# ### –î–æ–±–∞–≤—å—Ç–µ —Å—Ç–æ–ª–±–µ—Ü –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏, –∞ —Ç–∞–∫–∂–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å—Ç–æ–ª–±–µ—Ü –¥–∞—Ç;

# In[7]:


data['date'] = data['event_time'].dt.date
display(data.head())


# –¢–µ–ø–µ—Ä—å —É –Ω–∞—Å –µ—Å—Ç—å –Ω–æ–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å –¥–∞—Ç–∞–º–∏

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è**
#    
#  –ú–æ–ª–æ–¥–µ—Ü, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—à—å –¥–∞—Ç—ã –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É 
# 
# </div>

# In[8]:


data = data.drop_duplicates()


# In[9]:


data.duplicated().sum()


# –¥–∞—Ç–∞ –Ω–µ —Å–æ–¥—Ä–µ–∂–∏—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

# In[10]:


data.isnull().sum()


# –≤ –¥–∞—Ç–µ —Ç–∞–∫–∂–µ –Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –ù–µ –∑–∞–±—ã–≤–∞–π –≤—ã–ø–æ–ª–Ω—è—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –¥—É–±–ª–∏–∫–∞—Ç—ã
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# –¢–µ–ø–µ—Ä—å –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π

# ## –ò–∑—É—á–∏—Ç–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∞–Ω–Ω—ã–µ

# ### –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ —Å–æ–±—ã—Ç–∏–π –≤ –ª–æ–≥–µ?

# In[11]:


print(data['event_name'].nunique())
print(data['event_name'].unique())


# In[12]:


print(data.shape[0])


# –≤—Å–µ–≥–æ —É –Ω–∞—Å 243713 —Å–æ–±—ã—Ç–∏–π

# ### –°–∫–æ–ª—å–∫–æ –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ª–æ–≥–µ?

# In[13]:


print(data['device_id'].nunique())


# –∏ 7551 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# ### –°–∫–æ–ª—å–∫–æ –≤ —Å—Ä–µ–¥–Ω–µ–º —Å–æ–±—ã—Ç–∏–π –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?

# In[14]:


print(round(data.shape[0]/data['device_id'].nunique(), 2))


# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –ù–µ —Å—Ç–æ–∏—Ç –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å —á–∏—Å–ª–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ c –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã - –ª–µ–≥–∫–æ –¥–æ–ø—É—Å—Ç–∏—Ç—å –æ—à–∏–±–∫—É, –∏ —Ä–∞—Å—á–µ—Ç—ã –±—É–¥—É—Ç –Ω–µ –≤–µ—Ä–Ω—ã. –ï—Å–ª–∏ –∂–µ –º—ã –ø–æ–ª—É—á–∏–º —á–∏—Å–ª–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é –∫–æ–¥–∞ - —Ç–∞–∫–æ–π –ø—Ä–æ–±–ª–µ–º—ã –Ω–µ –±—É–¥–µ—Ç 
#    
# 
# </div>
# 

# –ù–∞ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Å—Ä–µ–¥–Ω–µ–º –ø—Ä–∏—Ö–æ–¥–∏—Ç 32 —Å–æ–±—ã—Ç–∏—è

# ### –î–∞–Ω–Ω—ã–º–∏ –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –≤—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç–µ? –ù–∞–π–¥–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É. –ò–∑—É—á–∏—Ç–µ, –∫–∞–∫ –º–µ–Ω—è–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö: –ø–æ—Å—Ç—Ä–æ–π—Ç–µ —Å—Ç–æ–ª–±—á–∞—Ç—É—é –¥–∏–∞–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤ —Ä–∞–∑—Ä–µ–∑–µ –≥—Ä—É–ø–ø. –ú–æ–∂–Ω–æ –ª–∏ –±—ã—Ç—å —É–≤–µ—Ä–µ–Ω–Ω—ã–º, —á—Ç–æ —É –≤–∞—Å –æ–¥–∏–Ω–∞–∫–æ–≤–æ –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞ –≤–µ—Å—å –ø–µ—Ä–∏–æ–¥? –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤ –ª–æ–≥–∏ –Ω–æ–≤—ã—Ö –¥–Ω–µ–π –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –º–æ–≥—É—Ç ¬´–¥–æ–µ–∑–∂–∞—Ç—å¬ª —Å–æ–±—ã—Ç–∏—è –∏–∑ –ø—Ä–æ—à–ª–æ–≥–æ ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç ¬´–ø–µ—Ä–µ–∫–∞—à–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ¬ª. –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, —Å –∫–∞–∫–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª–Ω—ã–µ –∏ –æ—Ç–±—Ä–æ—Å—å—Ç–µ –±–æ–ª–µ–µ —Å—Ç–∞—Ä—ã–µ. –î–∞–Ω–Ω—ã–º–∏ –∑–∞ –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã —Ä–∞—Å–ø–æ–ª–∞–≥–∞–µ—Ç–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ?

# In[15]:


min_date = data['date'].min()
max_date = data['date'].max()

print(f"–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞: {min_date}")
print(f"–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞: {max_date}")


# –¥–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã —Å 25 –∏—é–ª—è –ø–æ 7 –∞–≤–≥—É—Å—Ç–∞ 2019 –≥–æ–¥–∞

# In[16]:


event_date = data['date'].value_counts().sort_index()

plt.figure(figsize=(10,5))
event_date.plot(kind='bar')
plt.xlabel('–î–∞—Ç–∞')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π')
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –ø–æ –¥–∞—Ç–∞–º')
plt.xticks(rotation=90)
plt.show()


# —Ç–µ–ø–µ—Ä—å –Ω–∞–≥–ª—è–¥–Ω–æ –≤–∏–¥–Ω–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Å–æ–±—Ä–∞–Ω—ã –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ —Å –ø–µ—Ä–≤–æ–≥–æ –ø–æ —Å–µ–¥—å–º–æ–µ –∞–≤–≥—É—Å—Ç–∞, —Ç–æ –µ—Å—Ç—å –∑–∞ –Ω–µ–¥–µ–ª—é

# In[17]:


start_date = pd.to_datetime('2019-08-01').date()
data_new = data[data['date'] >= start_date]


# —Ç–µ–ø–µ—Ä—å –Ω–∞—à–∞ –¥–∞—Ç–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –ø–µ—Ä–∏–æ–¥

# ### –ú–Ω–æ–≥–æ –ª–∏ —Å–æ–±—ã—Ç–∏–π –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—ã –ø–æ—Ç–µ—Ä—è–ª–∏, –æ—Ç–±—Ä–æ—Å–∏–≤ —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ?

# In[18]:


print(f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã "–ø–æ—Ç–µ—Ä—è–ª–∏" {data["device_id"].nunique() - data_new["device_id"].nunique()}')


# In[19]:


print(f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã "–ø–æ—Ç–µ—Ä—è–ª–∏" {data.shape[0] - data_new.shape[0]}')


# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –ü–æ –≥—Ä–∞—Ñ–∏–∫—É –ª–æ–≥–æ–≤ –≤—ã—à–µ –≤–∏–¥–Ω–æ, —á—Ç–æ —Å–æ–±—ã—Ç–∏—è –¥–æ 01-08 –±—ã–ª–∏, —Ç–∞–∫ –∫–∞–∫ –º–æ–≥–ª–æ –ø–æ–ª—É—á–∏—Ç—å—Å—è, —á—Ç–æ, –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—è –ø–æ –¥–∞—Ç–µ, –º—ã –Ω–µ –ø–æ—Ç–µ—Ä—è–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å–æ–±—ã—Ç–∏—è?
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ—Å—á–∏—Ç–∞–ª —Å–æ–±—ã—Ç–∏—è —Ç—É—Ç, –Ω–∞—à–µ–ª —Å–Ω–∞—á–∞–ª–∞ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –¥–∞—Ç–µ, –∞ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
# 
# —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤—Å–µ –≤–µ—Ä–Ω–æ
# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚úîÔ∏è**
#    
#    –î–∞, —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—á–µ—Ç—ã –≤–µ—Ä–Ω—ãüëç
# 
# </div>
#     

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚ùå**
#    
#    –ü–æ—Ç–µ—Ä–∏ –ø–æ —Å–æ–±—ã—Ç–∏—è–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Ç–∞–∫–∂–µ —Å—Ç–æ–∏—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª—è—Ö
# 
# </div>
# 

# In[20]:


data_change1 = (data["device_id"].nunique() - data_new["device_id"].nunique())/data["device_id"].nunique()
data_change2 = ((data.shape[0] - data_new.shape[0])/data.shape[0])
print(f'–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã "–ø–æ—Ç–µ—Ä—è–ª–∏"{data_change1:.2%}')
print(f'–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –º—ã "–ø–æ—Ç–µ—Ä—è–ª–∏" {data_change2:.2%}')


# –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã, –ø–æ—Ç–µ—Ä—è–ª–∏ –º–µ–Ω—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≤ —Ä–∞–π–æ–Ω–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π

# ### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ –≤—Å–µ—Ö —Ç—Ä—ë—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø.

# In[21]:


print(data_new.groupby('expld')['device_id'].nunique())


# –≤–æ –≤—Å–µ—Ö –≥—Ä—É–ø–ø–∞—Ö –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚úîÔ∏è**
#    
#    –í–µ—Ä–Ω–æüëç
# 
# </div>
# 

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –í–æ–æ–±—â–µ, –∑–¥–µ—Å—å —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–º–µ–Ω–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç device_id)
# 
# </div>
# 

# ## –ò–∑—É—á–∏—Ç–µ –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π

# In[22]:


data = data_new #data –±—ã—Å—Ç—Ä–µ–µ –ø–∏—Å–∞—Ç—å, —á–µ–º data_new


# ### –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ, –∫–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –µ—Å—Ç—å –≤ –ª–æ–≥–∞—Ö, –∫–∞–∫ —á–∞—Å—Ç–æ –æ–Ω–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –ø–æ —á–∞—Å—Ç–æ—Ç–µ.

# In[23]:


data_event = data['event_name'].value_counts().sort_values(ascending=False)
display(data_event)


# –ø–æ–ª—É—á–∞–µ—Ç—Å—è –¥–∞–∂–µ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π, –µ—Å–ª–∏ –Ω–µ —Å—á–∏—Ç–∞—Ç—å tutorial

# ### –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ, —Å–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–æ–≤–µ—Ä—à–∞–ª–∏ –∫–∞–∂–¥–æ–µ –∏–∑ —ç—Ç–∏—Ö —Å–æ–±—ã—Ç–∏–π. –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è –ø–æ —á–∏—Å–ª—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –¥–æ–ª—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—å —Ä–∞–∑ —Å–æ–≤–µ—Ä—à–∞–ª–∏ —Å–æ–±—ã—Ç–∏–µ.

# In[24]:


user_per_event = data.groupby('event_name')['device_id'].nunique().sort_values(ascending=False)

total_number = data['device_id'].nunique()

user_per_event = user_per_event.reset_index()
user_per_event.columns = ['event_name', 'unique_users']

user_per_event['user_share'] = (user_per_event['unique_users'] / total_number * 100).apply(lambda x: f'{x:.2f}%')

display(user_per_event)


# –µ—Å–ª–∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç–∞–¥–∏–∏, —Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

# ### –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏—Ç–µ, –≤ –∫–∞–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —Å–æ–±—ã—Ç–∏—è. –í—Å–µ –ª–∏ –æ–Ω–∏ –≤—ã—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—É—é —Ü–µ–ø–æ—á–∫—É? –ò—Ö –Ω–µ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ –≤–æ—Ä–æ–Ω–∫–∏.

# –ª–æ–≥–∏—á–µ—Å–∫–∏ –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å–≤—Ç–∏–π –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ç–∞–∫–æ–π:
# 
# 1) MainScreenAppear	
# 
# 2) OffersScreenAppear	
# 
# 3) CartScreenAppear
# 
# 4) PaymentScreenSuccessful	
# 
# –ê Tutorial	–º–æ–∂–µ—Ç –∏–¥—Ç–∏ —Å–∞–º—ã–º –ø–µ—Ä–≤—ã–º, –Ω–æ —è —Ç–∞–∫ –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —ç—Ç–æ –æ–ø—Ü–∏–ø–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –µ—Å–ª–∏ —á–µ—Å—Ç–Ω–æ–± –Ω–µ–º–Ω–æ–≥–æ —Å—Ç—Ä–∞–Ω–Ω–æ, —á—Ç–æ –ª—é–¥—è–º –Ω—É–∂–Ω–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ, –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∞–π—Ç–æ–º, —Ç–∞–∫ —á—Ç–æ —Å—á–∏—Ç–∞—é, —á—Ç–æ —ç—Ç–æ –æ–ø—Ü–∏—è
# 
# –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –≤—ã–≥–ª—è–¥–∏—Ç –≤–ø–æ–ª–Ω–µ –ª–æ–≥–∏—á–Ω–æ

# ### –ü–æ –≤–æ—Ä–æ–Ω–∫–µ —Å–æ–±—ã—Ç–∏–π –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ, –∫–∞–∫–∞—è –¥–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–æ—Ö–æ–¥–∏—Ç –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ –≤–æ—Ä–æ–Ω–∫–∏ (–æ—Ç —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º). –¢–æ –µ—Å—Ç—å –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π A ‚Üí B ‚Üí C –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–æ–±—ã—Ç–∏–µ–º B –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–æ–±—ã—Ç–∏–µ–º A, –∞ —Ç–∞–∫–∂–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —á–∏—Å–ª–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–æ–±—ã—Ç–∏–µ–º C –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Å–æ–±—ã—Ç–∏–µ–º B.

# In[25]:


conversion_rates = []

for i in range(len(user_per_event)):
    if i == 0:
        conversion_rate = None  # –î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –≤–æ—Ä–æ–Ω–∫–∏ –Ω–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞
    else:
        current_users = user_per_event.loc[i - 1, 'unique_users']
        next_users = user_per_event.loc[i, 'unique_users']
        conversion_rate = next_users / current_users
    conversion_rates.append(conversion_rate)

user_per_event['conversion_rate'] = conversion_rates

display(user_per_event)


# –¥–∞–Ω–Ω—ã–µ –≤—ã–≥–ª—è–¥—è—Ç –≤–µ—Å—å–º–∞ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–º–∏, –µ—Å–ª–∏ –Ω–µ –≤–∫–ª—é—á–∞—Ç—å Tutorial –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π

# ### –ù–∞ –∫–∞–∫–æ–º —à–∞–≥–µ —Ç–µ—Ä—è–µ—Ç–µ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π?

# –µ—Å–ª–∏ –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å tutorial, —Ç–æ OffersScreenAppear, –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 62 –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
# 
# —Ç–æ –µ—Å—Ç—å 38 –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–µ –ø–µ—Ä–µ—à–ª–∏ —Å –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—á–∫–∏ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π

# In[26]:


user_per_event=user_per_event[user_per_event['event_name'] != 'Tutorial']


# In[27]:


fig = go.Figure(go.Funnel(
    y = user_per_event['event_name'],
    x = user_per_event['unique_users'],
    textposition = "inside",
    textinfo = "value+percent initial",
    opacity = 0.65, marker = {"color": ["deepskyblue", "lightsalmon", "tan", "teal", "silver"]}))
fig.update_layout(title='–í–æ—Ä–æ–Ω–∫–∞ —Å–æ–±—ã—Ç–∏–π', title_x = 0.5)                   
fig.show()


# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚ùå**
#    
#    
# –ì—Ä–∞—Ñ–∏–∫—É –≤–æ—Ä–æ–Ω–∫–∏ —Å—Ç–æ–∏—Ç –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ - —ç—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å –ø–æ–º–æ—â—å—é —Å—Ç—Ä–æ–∫–∏: `fig.update_layout(title='–í–æ—Ä–æ–Ω–∫–∞', title_x = 0.5)`
# </div>
# 

# –¢–µ–ø–µ—Ä—å –Ω–∞–≥–ª—è–¥–Ω–æ –≤–∏–¥–Ω–æ, –∫–∞–∫ –∏–º–µ–Ω–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–µ–±—è –≤–µ–¥—É—Ç
# 
# –Ø–≤–Ω–æ, —á—Ç–æ –µ—Å—Ç—å –µ—â–µ –ø—Ä–æ–±–ª–µ–º–∞ —Å —Ç–µ–º, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Ç–∞–∫ –∞–∫—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç —Å MainScreenAppear –Ω–∞ OffersScreenAppear

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è** 
#    
#    –û—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ - –ø—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ - –ø—Ä–æ–≤–∞–ª –Ω–∞ –ø–µ—Ä–≤–æ–º —à–∞–≥–µ: –æ—Ç `MainScreenAppear` –∫ `OffersScreenAppear`. –í–µ—Ä–æ—è—Ç–Ω–æ, –Ω—É–∂–Ω–æ –ª—É—á—à–µ –ø—Ä–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–µ—Ö–∞–Ω–∏–∫—É, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–ª–∏ –∫ `OffersScreen`.
#     
# `Tutorial`, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å.
# </div>
# 

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –í–æ—Ä–æ–Ω–∫—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –ø–æ–º–æ—â—å—é –≥—Ä–∞—Ñ–∏–∫–∞ - –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π —Ç–∏–ø –≥—Ä–∞—Ñ–∏–∫–∞, –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏, –∏–ª–∏ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –ø–æ plotly –Ω–∏–∂–µ
# 
# </div>
# <div class="alert alert-warning">
# 
# **‚ö†Ô∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ö†Ô∏è**
#    
#    
#    –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º `plotly` –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≤–æ—Ä–æ–Ω–æ–∫ - –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç–µ: https://habr.com/ru/company/otus/blog/588190/ –ù–µ –∑–∞–±—É–¥—å –∏—Å–∫–ª—é—á–∏—Ç—å tutorial —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫ —É –≤–æ—Ä–æ–Ω–∫–∏.
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# –∏—Å–ø—Ä–∞–≤–∏–ª, —Ç–µ–ø–µ—Ä—å –∏ –ø—Ä–∞–≤–¥—É –ª—É—á—à–µ

# ### –ö–∞–∫–∞—è –¥–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ—Ö–æ–¥–∏—Ç –æ—Ç –ø–µ—Ä–≤–æ–≥–æ —Å–æ–±—ã—Ç–∏—è –¥–æ –æ–ø–ª–∞—Ç—ã?

# In[28]:


# –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
total_users = data['device_id'].nunique()

# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–ø–ª–∞—Ç—É
payment_users = data[data['event_name'] == 'PaymentScreenSuccessful']['device_id'].nunique()

# –î–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–ø–ª–∞—Ç—É
conversion_rate = payment_users / total_users

print(f"–î–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–µ—Ä—à–∏–ª–∏ –æ–ø–ª–∞—Ç—É: {conversion_rate:.2%}")


# 47% –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–æ—à–ª–∏ –æ—Ç —Å–≤–æ–µ–≥–æ —Å–æ–±—ã—Ç–∏—è –¥–æ –æ–ø–ª–∞—Ç—ã

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –í–æ—Ç —Ç–∞–∫—É—é —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –ø–æ –¢–ó —É –Ω–∞—Å –Ω–µ—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è –ø–æ—Å–µ—â–µ–Ω–∏—è MainScreenAppear –¥–ª—è —Å–æ–≤–µ—Ä—à–µ–Ω–∏—è –ø–æ–∫—É–ø–∫–∏ - –¥–∞–Ω–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –±—É–¥–µ—Ç –ª–∏—à—å —á–∞—Å—Ç–Ω—ã–º —Å–ª—É—á–∞–µ–º
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# —Ç–µ–ø–µ—Ä—å –∑–∞ –ø–µ—Ä–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å—á–∏—Ç–∞—é —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –ª—é–±–æ–µ, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ MainScreenAppear
# 
# —Ç–∞–∫ —á—Ç–æ —Å–µ–π—á–∞—Å –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–µ—Ä–Ω–æ

# ## –ò–∑—É—á–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞

# ### –°–∫–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ?

# In[29]:


unique_users_per_group = data.groupby('expld')['device_id'].nunique()
print("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –∫–∞–∂–¥–æ–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–µ:")
print(unique_users_per_group)


# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚ùå**
#    
#    –î–æ–±–∞–≤—å –≤—ã—à–µ device_id, —á—Ç–æ–±—ã –≤—ã–≤–æ–¥–∏–ª–∏—Å—å –∏–º–µ–Ω–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# –¢–µ–ø–µ—Ä—å –ø–æ–Ω—è–ª, —á—Ç–æ –Ω–µ —Ç–∞–∫     

# –í –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –ó–¥–µ—Å—å –≤—ã–≤–µ–¥–µ–Ω—ã —Å–æ–±—ã—Ç–∏—è - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ - —ç—Ç–æ device_id. –ü–æ—Å–ª–µ –≤—ã–≤–æ–¥–∞ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å—Ç–æ–∏—Ç —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞–ª —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ
# 
# </div>
# 

# In[30]:


# –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞–ª —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ
user_groups = data.groupby('device_id')['expld'].nunique()
multiple_groups_users = user_groups[user_groups > 1].count()

print(f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –±–æ–ª–µ–µ —á–µ–º –æ–¥–Ω–æ–π –≥—Ä—É–ø–ø–µ: {multiple_groups_users}')


# –ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥—Ä—É–ø–ø–∞—Ö

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚úîÔ∏è**
#    
#    –°–æ–≥–ª–∞—Å–µ–Ωüëç
# 
# </div>
# 

# ### –ï—Å—Ç—å 2 –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≥—Ä—É–ø–ø—ã –¥–ª—è –ê/–ê-—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞, —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –∏ —Ä–∞—Å—á—ë—Ç–æ–≤. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –Ω–∞—Ö–æ–¥—è—Ç –ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –≤—ã–±–æ—Ä–∫–∞–º–∏ 246 –∏ 247.
# 
# ### –í—ã–±–µ—Ä–∏—Ç–µ —Å–∞–º–æ–µ –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ —á–∏—Å–ª–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –≤ –∫–∞–∂–¥–æ–π –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –¥–æ–ª—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –±—É–¥–µ—Ç –ª–∏ –æ—Ç–ª–∏—á–∏–µ –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—ã–º. –ü—Ä–æ–¥–µ–ª–∞–π—Ç–µ —Ç–æ –∂–µ —Å–∞–º–æ–µ –¥–ª—è –≤—Å–µ—Ö –¥—Ä—É–≥–∏—Ö —Å–æ–±—ã—Ç–∏–π (—É–¥–æ–±–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é). –ú–æ–∂–Ω–æ –ª–∏ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ –≥—Ä—É–ø–ø—ã —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ?

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –≠—Ç–æ —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏
# 
# </div>
# 

# <div class="alert alert-block alert-info">
# –ø–µ—Ä–µ–Ω–µ—Å –≤ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫—É
# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚úîÔ∏è**
#    
#    üëç
# 
# </div>
#     

# In[31]:


data_groups = data.pivot_table(index='event_name', values='device_id', columns='expld', aggfunc='nunique').reset_index()
data_groups['rate_246'] = (data_groups[246] / data_groups[246].sum()*100).apply(lambda x: f'{x:.2f}%')
data_groups['rate_247'] = (data_groups[247] / data_groups[247].sum()*100).apply(lambda x: f'{x:.2f}%')
data_groups['rate_248'] = (data_groups[248] / data_groups[248].sum()*100).apply(lambda x: f'{x:.2f}%')
display(data_groups)


# –≤–µ–∑–¥–µ —Å–∞–º–æ–µ —á–∞—Å—Ç–æ–µ —Å–æ–±—ã—Ç–∏–µ - —ç—Ç–æ MainScreenAppear

# In[32]:


def z_test(data, n1, n2):
    for i in range(len(data_groups) - 1):
        alpha = 0.01
        success1 = data_groups[n1].loc[i]
        success2 = data_groups[n2].loc[i]
        trials1 = data_groups[n1].sum()
        trials2 = data_groups[n2].sum()
    
        p1 = success1 /trials1
        p2 = success2 /trials2
    
        p_combined = (success1 + success2) / (trials1 + trials2)
    
        difference = p1 - p2
    
        z_value = difference / mth.sqrt(p_combined * (1 - p_combined) * (1/trials1 + 1/trials2))
        distr = st.norm(0, 1)  
        p_value = (1 - distr.cdf(abs(z_value))) * 2
    
        print(f'–¢–µ—Å—Ç –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –¥–ª—è –≥—Ä—É–ø–ø {n1} –∏ {n2} —Å–æ–±—ã—Ç–∏—è {data_groups.loc[i, "event_name"]}')
        print('p-–∑–Ω–∞—á–µ–Ω–∏–µ: ', p_value)

        if p_value < alpha:
            print('–û—Ç–≤–µ—Ä–≥–∞–µ–º –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞')
        else:
            print(
            '–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É, –Ω–µ—Ç –æ—Å–Ω–æ–≤–∞–Ω–∏–π —Å—á–∏—Ç–∞—Ç—å –¥–æ–ª–∏ —Ä–∞–∑–Ω—ã–º–∏'
        )
        print('_'*80)


# –ü—Ä–æ–≤–µ–¥–µ–º –ê/–ê —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–æ—Ç–µ–ª–µ–π 
# 
# 
# –ù0: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –Ω–µ—Ç –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã
# 
# –ù1: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞

# In[33]:


z_test(data, 246, 247)


# –∫–∞–∫ –∏ –æ–∂–∏–¥–∞–ª–æ—Å—å, –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ 246 –∏ 247 –Ω–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π

# ### –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ø–æ—Å—Ç—É–ø–∏—Ç–µ —Å –≥—Ä—É–ø–ø–æ–π —Å –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–º —à—Ä–∏—Ñ—Ç–æ–º. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –∫–∞–∂–¥–æ–π –∏–∑ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø –≤ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–æ–±—ã—Ç–∏—é. –°—Ä–∞–≤–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π –≥—Ä—É–ø–ø–æ–π. –ö–∞–∫–∏–µ –≤—ã–≤–æ–¥—ã –∏–∑ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?

# –ü—Ä–æ–≤–µ–¥–µ–º –ê/–í —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–æ—Ç–µ–ª–µ–π –≥—Ä—É–ø–ø 246 –∏ 248
# 
# –ù0: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –Ω–µ—Ç –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã
# 
# –ù1: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞

# In[34]:


z_test(data, 246, 248)


# –ù—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –Ω–∏–≥–¥–µ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å, –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ 246 –∏ 248 –Ω–µ—Ç—É

# –ü—Ä–æ–≤–µ–¥–µ–º –ê/–í —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–æ—Ç–µ–ª–µ–π –≥—Ä—É–ø–ø 247 –∏ 248
# 
# –ù0: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –Ω–µ—Ç –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã
# 
# –ù1: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞

# In[35]:


z_test(data, 247, 248)


# –ù—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –Ω–∏–≥–¥–µ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å, –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ 247 –∏ 248 –Ω–µ—Ç—É

# In[36]:


data_groups[249] = data_groups[246] + data_groups[247]
display(data_groups)


# –°–æ–∑–¥–∞–ª–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—É—é –≥—Ä—É–ø–ø—É –ø–æ–¥ –Ω–æ–º–µ—Ä–æ–º 249
# 
# –ü—Ä–æ–≤–µ–¥–µ–º –ê/–í —Ç–µ—Å—Ç –¥–ª—è –¥–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–æ—Ç–µ–ª–µ–π –≥—Ä—É–ø–ø 249 –∏ 248
# 
# –ù0: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –Ω–µ—Ç –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã
# 
# –ù1: –º–µ–∂–¥—É –¥–æ–ª—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ–≤–µ—Ä—à–∏–≤—à–∏—Ö —Å–æ–±—ã—Ç–∏–µ, –µ—Å—Ç—å –∑–Ω–∞—á–∏–º–∞—è —Ä–∞–∑–Ω–∏—Ü–∞

# In[37]:


z_test(data, 249, 248)


# –ù—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –Ω–∏–≥–¥–µ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å –æ—Ç–≤–µ—Ä–≥–Ω—É—Ç—å, –∑–Ω–∞—á–∏–º–æ–π —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É –≥—Ä—É–ø–ø–∞–º–∏ 249 –∏ 248 –Ω–µ—Ç—É

# ### –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –≤—ã –≤—ã–±—Ä–∞–ª–∏ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑ –≤—ã—à–µ? –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ, —Å–∫–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–æ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –≥–∏–ø–æ—Ç–µ–∑ –≤—ã —Å–¥–µ–ª–∞–ª–∏. –ü—Ä–∏ —É—Ä–æ–≤–Ω–µ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ 0.1 –≤ 10% —Å–ª—É—á–∞–µ–≤ –º–æ–∂–Ω–æ –æ—à–∏–±–æ—á–Ω–æ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –Ω—É–ª–µ–≤—É—é –≥–∏–ø–æ—Ç–µ–∑—É –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –æ–Ω–∞ –≤–µ—Ä–Ω–∞. –ö–∞–∫–æ–π —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ —Å—Ç–æ–∏—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å? –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –µ–≥–æ, –ø—Ä–æ–¥–µ–ª–∞–π—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –ø—É–Ω–∫—Ç—ã –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –≤—ã–≤–æ–¥—ã.

# –£—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –ø–æ—Å—Ç–∞–≤–∏–ª 10 –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –∏ –º–µ–Ω—è—Ç—å –µ–≥–æ –Ω–µ –≤–∏–∂—É —Å–º—ã—Å–ª–∞. P-value –≤–µ–∑–¥–µ, –≤ 16 —Ç–µ—Å—Ç–∞—Ö, –∫—Ä–∞–π–Ω–µ –≤—ã—Å–æ–∫–∏–π, –≤–µ–∑–¥–µ –≤—ã—à–µ 0.35. –¢–∞–∫ —á—Ç–æ –æ—Å—Ç–∞–≤–∏–º —ç—Ç–æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è**
#    
# 
#    –°–æ–≥–ª–∞—Å–µ–Ω, –≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ —É—Ä–æ–≤–µ—Ä–Ω—å –Ω–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç - –æ–¥–Ω–∞–∫–æ, —Ç–∞–∫ –∫–∞–∫ –º—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –≥–∏–ø–æ—Ç–µ–∑, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø–æ–ø—Ä–∞–≤–∫–∞–º–∏ –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –≥–∏–ø–æ—Ç–µ–∑: https://studfile.net/preview/10706903/page:19/ –∏ –∏–∑—É—á–∏—Ç—å, –∫–∞–∫ –º–æ–∂–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å –∞–ª—å—Ñ–∞.
# –¢–∞–∫–∂–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—é —Å—Ç–∞—Ç—å—é: https://habr.com/ru/company/yandex/blog/476826/ - –≤ –Ω–µ–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –•–æ–ª–º–∞ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `statsmodels` - –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º                    
# 
# </div>
# 
# 
# 

# # –í—ã–≤–æ–¥
# 
# –î–ª—è –Ω–∞—à–µ–≥–æ —Å—Ç–∞—Ä—Ç–∞–ø–∞ –º—ã:
# 
# 1) –ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ
# 
# 3) –ò–∑—É—á–∏–ª–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ. –û—á–∏—Å—Ç–∏–ª–∏ –¥–∞—Ç—É –æ—Ç –ø–µ—Ä–∏–æ–¥–æ–≤, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ
# 
# 4) –ò–∑—É—á–∏–ª–∏ –≤–æ—Ä–æ–Ω–∫—É —Å–æ–±—ã—Ç–∏–π. –£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏, —á—Ç–æ –µ—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π, –∞ –∏–º–µ–Ω–Ω–æ MainScreenAppear -> OffersScreenAppear -> CartScreenAppear -> PaymentScreenSuccessful. –¢–∞–∫–∂–µ –ø–æ–Ω—è–ª–∏, —á—Ç–æ –º–∞–ª–æ –∫—Ç–æ –ø–æ–ª—å–∑—É–µ—Ç—Å—è Tutorial
# 
# 5) –ò–∑—É—á–∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –∏ –≤—ã—è—Å–Ω–∏–ª–∏, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —à—Ä–∏—Ñ—Ç–∞ –Ω–∏–∫–∞–∫ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í—Å–µ —Ç–∞–∫–∂–µ –ø–µ—Ä–µ—Ö–æ–¥—è—Ç –º–µ–∂–¥—É "—Å–æ–±—ã—Ç–∏—è–º–∏", —Ç–µ—Å—Ç –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö –≥—Ä—É–ø–ø, —Ç–∞–∫–∂–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–π –≥—Ä—É–ø–ø—ã, –ø–æ–∫–∞–∑–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
# 
# –í –∏—Ç–æ–≥–µ, –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –Ω–µ —É—Å–ø–µ—à–µ–Ω, –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ—Å—Ç–∞–ª–æ—Å—å —Ç–∞–∫–∏–º –∂–µ!!!

# <div class="alert alert-danger">
# 
# **‚ùå –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚ùå**
#    
#    –ö–∞–∫–æ–π –≤—ã–≤–æ–¥ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ - –æ–Ω —É—Å–ø–µ—à–µ–Ω?
# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v2‚úîÔ∏è**
#    
#    –°–æ–≥–ª–∞—Å–µ–Ω, —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è
# 
# </div>
# 
# </div>
# 

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ ‚úîÔ∏è**
#    
#    –ì–µ–æ—Ä–≥–∏–π, –ø—Ä–æ–≤–µ–¥–µ–Ω –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑. –í—Å–µ –Ω–∞–≥–ª—è–¥–Ω–æ - –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –≤—ã–≤–æ–¥—ã. –£—á—Ç–∏ –º–æ–∏ –∑–∞–º–µ—á–∞–Ω–∏—è. –í–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–µ–º–Ω–æ–≥–æ –ø–æ–¥–ø—Ä–∞–≤–∏—Ç—å –≤—ã–≤–æ–¥—ã. –ñ–¥—É —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç –Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ —Ä–µ–≤—å—é. –£—Å–ø–µ—Ö–æ–≤!
# 
# </div>
# 

# <div class="alert alert-success">
# 
# **‚úîÔ∏è –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞ v3‚úîÔ∏è**
#    
#    –ì–µ–æ—Ä–≥–∏–π, –∑–∞–º–µ—á–∞–Ω–∏—è —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã üëç. –£–≤–µ—Ä–µ–Ω, –º–æ–∏ —Å–æ–≤–µ—Ç—ã –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è —Ç–µ–±–µ –≤ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö. –£—Å–ø–µ—Ö–æ–≤ –≤ –æ–±—É—á–µ–Ω–∏–∏! üòâ 
# 
# </div>
